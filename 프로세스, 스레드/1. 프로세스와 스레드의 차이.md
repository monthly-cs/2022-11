# **프로세스와 스레드의 차이**

이 문서는 2022년 11월 09일에 @kwanyung에 의해서 작성되었습니다.

```
1. 프로세스
    - 프로세스란?
    - 멀티 태스킹
2. 스레드
    - 스레드란?
3. 프로세스와 스레드

4. 멀티 프로세스와 멀티 스레드
    - 멀티 프로세스
    - 멀티 스레드
    - 멀티 프로세스 vs 멀티 스레드
```

# 1. **프로세스**

## 1-1. **프로세스란?**

```
프로그램 : 어떤 작업을 위해 실행할 수 있는 파일!
.exe 등..
```

프로세스

> **메모리에 적재되고 CPU 자원을 할당받아 프로그램이 실행되고 있는 상태**

> 메모리를 할당받아 실행하고 있는 프로그램의 인스턴스(독립적인 개체)<br>

> 인스턴스 생성 : 프로그램 실행에 필요한 내용이 컴퓨터 메모리(RAM)에 적재된다는 이야기.


![프로세스의 구성](https://user-images.githubusercontent.com/71562311/201459250-8aeb1562-ee56-4a7f-9604-24928dec8ff5.png)

CPU는 프로세스 실행을 위한 자원을 주게됨.

-   CPU 시간

-   운영되기 위해 필요한 주소의 공간
-   Code, Data, Stack, Heap의 구조로 되어 있는 독립된 메모리 영역

**기본적으로 프로세스당 최소 1개의 스레드를 가지고 있음**

---

## 1-2. **멀티 태스킹**

운영체제를 통해 CPU가 작업하는데 필요한 자원을 프로세스나 스레드끼리 나누는 행위.

> 이를 이용해 음악을 들으며 영상을 재생하며 작업을 진행할 수 있는 것!

-   코드 영역(code area) : 프로그래머가 작성한 프로그램이 코드 영역에 작성된다(정적)
-   데이터 영역(data area) : 코드가 실행되면서 사용한 변수나 파일들의 각종 데이터들이 모여있다.(정적)
-   스택 영역(stack area) : 호출한 함수가 종료되면 되돌아올 메모리의 주소를 스택에 저장하거나 변수 사용 범위에 영향을 미치는 영역을 구현 할때 사용된다.(동적)
-   힙 영역(heap area) : 동적으로 할당되는 데이터들을 위해 존재하는 공간이다. ex) malloc

---

## 2. **스레드**

-   **어떠한 프로그램 내에서, 프로세스 내에서 실행되는 흐름의 단위.**
-   프로세스를 생성하면 기본적으로 하나이상의 스레드를 생성.

![스레드](https://user-images.githubusercontent.com/71562311/201459257-52c3a1b4-ed24-4bf4-9dde-40788e1fc49c.png)


## 스레드의 특징

-   프로세스 내에서 각각 Stack만 할당받고 다른 영역은 공유함.
-   프로세스 내의 주소공간이나 자원들(힙 공간 등)을 같은 프로세스 내에 스레드끼리 공유.
-   한 스레드가 프로세스 자원을 변경하면 다른 이웃 스레드(sibling thread)도 그 변경 결과를 볼 수 있음.

---

# 3. **프로세스와 스레드**

-   **프로세스는 자원을 공유하지 않지만, 스레드는 자원을 공유!**

=> 프로세스가 요리의 메뉴라면<br>(햄버거, 김치볶음밥)<br>
이들은 서로 재료를 공유하지 않음.
<br>**스레드는 각 요리 메뉴의 작업 과정, 작업대라고 볼 수 있음.**
<br>햄버거는 빵, 야채, 패티, 빵 등의 과정으로 나누어져 각 파트별로 자원(요리사)을 할당하는 것.

---

# 4. **멀티 프로세스와 멀티 스레드**

## 4-1. **멀티 프로세스**

-   하나의 애플리케이션을 여러 개의 프로세스로 구성하여 각 프로세스가 하나의 작업을 처리하도록 하는 것.

    -   안정성이 좋으며 여러개의 자식 프로세스 중 하나에 문제가 발생해도, 다른 자식 프로세스에 영향이 확산되지 않음.
    -   구현이 비교적 간단하고, 각 프로세스들이 독립적으로 동작하며 자원의 서로 다르게 할당된다.
    -   프로세스 간 통신을 하기 위해서는 IPC를 통해야 함.
    -   메모리 사용량이 많음.

**Context Switching**

-   CPU에서 여러 프로세스를 돌아가며 작업을 처리하는 과정
-   동작 중인 프로레스가 대기를 하며 프로세스의 상태를 보관하고, 대기하고 있던 다음 프로세스가 동작하면서 이전에 보관했던 프로세스의 상태를 복구하는 작업.

멀티 프로세싱은

-
-   Context Switching 과정에서 캐시 메모리 초기화 등 무거운 작업이 진행되어 오버헤드가 발생하게 됨.

이라는 단점을 가지기에 이를 커버하고자 듀얼코어, 쿼드코어, 옥타코어 등 코어를 여러 개 달아서 작업을 분담할 수 있도록 만듦.

---

## 4-2 **멀티 스레드**

-   하나의 애플리케이션을 여러 개의 스레드로 구성해 하나의 스레드가 하나의 작업을 처리하도록 하는 것.

## 장점

-   응답성이 좋음. 프로그램의 일부분(자식 스레드)이 오류 또는 긴 작업으로 인해 중단되어도 프로그램이 계속 적으로 수행.
-   자원 공유가 쉽다. 스레드들은 부모 프로세스의 자원과 메모리를 공유 가능.
-   프로세스를 할당하는 것보다 스레드를 할당하는 것이 비용이 적음.
-   멀티프로세서 구조에서 각각의 스레드가 다른 프로세서에서 병렬로 수행될 수 있음.

## 단점

-   구현 및 테스트, 디버깅이 어려움.
-   너무 많은 스레드 사용은 오버헤드를 발생시킴.
-   동기화 그리고 교착상태가 발생하지 않도록 주의해야 한다.
-   자식 스레드 중 하나에 문제가 생긴경우 전체 프로세스에 영향을 줄 수 있다.

---

## 4-3 **멀티 스레드 vs 멀티 프로세스**

멀티 스레드 > 멀티 프로세스?

![멀티 스레드](https://user-images.githubusercontent.com/71562311/201459274-63426d8d-b60d-4c8c-b9db-251683c88fe8.png)

-   프로그램을 여러 개 키는 것 보다 하나의 프로그램 안에서 여러 작업을 해결.
    -   자원의 효율성 증대
        -   멀티 프로세스가 아닌 멀티 스레드로 실행하면 프로세스를 생성하여 자원을 할당하는 시스템 콜이 줄어 자월을 효율적으로 관리.
        -   Context Switching의 CPU레지스터 교체, RAM과 CPU사이의 캐시데이터까지 초기화 하여 오버헤드가 크기 때문
        -   프로세스 간 통신(IPC) 보다 스레드 간 통신 비용이 적으므로 작업들 간 통신의 부담이 줄어든다!

멀티 스레드는 공유되는 변수에 스레드 두개가 동시에 손을 대기에 충돌 가능성이 있음!
